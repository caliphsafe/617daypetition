<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Declaration of 617 Day — Petition</title>

  <style>
    :root{
      --page-bg: #fdf5e3;

      /* Image’s native size (given) */
      --imgW: 1280;
      --imgH: 2743;

      /* Where your text/petition starts on the image (given) */
      --startY: 1450; /* px from top */
      --bottomPad: 20; /* px from bottom */

      /* Ink color to match the doc */
      --ink: #4a3a2d;
      --ink2: rgba(74,58,45,.82);

      --maxW: 980px;
      --radius: 14px;

      --fieldBg: rgba(255,255,255,.55);
      --fieldStroke: rgba(74,58,45,.18);

      --btnBg: rgba(74,58,45,.94);
      --btnText: #f7f1e8;
    }

    *{ box-sizing: border-box; }
    html, body{ height: 100%; }
    body{
      margin: 0;
      background: var(--page-bg);
      color: var(--ink);
      font-family: Georgia, "Times New Roman", Times, serif;
    }

    /* Center the whole “poster” on the page */
    .page{
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 20px 14px 60px;
    }

    /* This box controls the width (image scales inside) */
    .poster{
      width: min(var(--maxW), 100%);
    }

    /* Holds the image and the overlay content */
    .img-wrap{
      position: relative;
      width: 100%;
    }

    /* Image scrolls with the page (normal flow) */
    .img-wrap img{
      width: 100%;
      height: auto;
      display: block;
    }

    /*
      Overlay content that sits ON TOP OF THE IMAGE.
      It starts at 1450px from the top of the image, scaled responsively:
        top = (startY / imgH) * 100%
      Its bottom = 20px from bottom, scaled responsively:
        bottom = (bottomPad / imgH) * 100%
    */
    .overlay{
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: min(78%, 720px); /* tweakable: keeps it inside parchment margins */
      top: calc((var(--startY) / var(--imgH)) * 100%);
      bottom: calc((var(--bottomPad) / var(--imgH)) * 100%);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 14px;
      pointer-events: auto; /* allow form interaction */
    }

    .overlay p{
      margin: 0;
      line-height: 1.62;
      font-size: 18px;
      color: var(--ink2);
      text-shadow: 0 1px 0 rgba(255,255,255,.35);
    }

    .section-title{
      margin-top: 10px;
      font-weight: 700;
      letter-spacing: .03em;
      text-transform: uppercase;
      font-size: 13px;
      color: rgba(74,58,45,.78);
    }

    /* Soft “ink-on-paper” form styling */
    .sign-area{
      margin-top: 6px;
      padding: 14px;
      border-radius: var(--radius);
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(74,58,45,.18);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }

    form{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items: end;
    }

    .field{
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label{
      font-size: 12px;
      letter-spacing: .02em;
      color: rgba(74,58,45,.8);
    }

    input{
      width: 100%;
      padding: 11px 12px;
      border-radius: 12px;
      border: 1px solid var(--fieldStroke);
      background: var(--fieldBg);
      color: var(--ink);
      outline: none;
      font-size: 15px;
    }

    input:focus{
      border-color: rgba(74,58,45,.35);
      box-shadow: 0 0 0 3px rgba(74,58,45,.10);
    }

    .full{ grid-column: 1 / -1; }

    .btn{
      grid-column: 1 / -1;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 12px 14px;
      border-radius: 12px;
      border: 0;
      background: var(--btnBg);
      color: var(--btnText);
      font-weight: 700;
      letter-spacing: .02em;
      cursor: pointer;
    }
    .btn:active{ transform: translateY(1px); }

    .signatures{
      margin-top: 12px;
      border-top: 1px dashed rgba(74,58,45,.25);
      padding-top: 10px;
    }

    .sig{
      display: flex;
      justify-content: space-between;
      gap: 12px;
      padding: 9px 8px;
      border-radius: 10px;
      background: rgba(255,255,255,.16);
      margin-bottom: 10px;
    }

    .sig .who{
      font-weight: 700;
      color: rgba(74,58,45,.9);
    }

    .sig .meta{
      color: rgba(74,58,45,.75);
      font-size: 13px;
      white-space: nowrap;
    }

    .empty{
      padding: 10px 8px;
      color: rgba(74,58,45,.7);
      font-size: 13px;
    }

    /* Mobile adjustments */
    @media (max-width: 720px){
      .overlay{
        width: 84%;
      }
      .overlay p{
        font-size: 16px;
      }
      form{
        grid-template-columns: 1fr;
      }
      .sig{
        flex-direction: column;
        align-items: flex-start;
      }
      .sig .meta{ white-space: normal; }
    }
  </style>
</head>

<body>
  <div class="page">
    <div class="poster">
      <div class="img-wrap">
        <!-- Your 1280x2743 image -->
        <img src="declaration-bg.png" alt="Declaration of 617 Day" />

        <!-- Overlay content appears ON the image at 1450px down -->
        <div class="overlay" aria-label="Continuation text and petition">
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi tincidunt, metus et iaculis dignissim, lorem lorem luctus massa, vel mattis massa lorem id est. Integer laoreet, arcu non cursus ultrices, urna neque commodo nibh, a luctus libero massa non ipsum.</p>
          <div class="section-title">Sign the Declaration</div>

          <section class="sign-area">
            <form id="signForm" autocomplete="on">
              <div class="field">
                <label for="firstName">First name</label>
                <input id="firstName" name="firstName" required maxlength="40" />
              </div>

              <div class="field">
                <label for="lastName">Last name</label>
                <input id="lastName" name="lastName" required maxlength="60" />
              </div>

              <div class="field full">
                <label for="area">Part of the city you’re from (e.g., Dorchester)</label>
                <input id="area" name="area" required maxlength="80" />
              </div>

              <div class="field">
                <label for="email">Email</label>
                <input id="email" name="email" type="email" required />
              </div>

              <div class="field">
                <label for="zip">Zip code</label>
                <input id="zip" name="zip" inputmode="numeric" autocomplete="postal-code pattern="\d{5}" minlength="5" maxlength="5" required />
              </div>

              <button class="btn" type="submit">Sign</button>
            </form>

            <div class="signatures" aria-label="Signatures list">
              <div class="section-title" style="margin-top:0">Signatures</div>
              <div id="sigList"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "decl617_signatures_v1";

    function loadSigs(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
      catch(e){ return []; }
    }
    function saveSigs(sigs){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(sigs));
    }

    function cap(s){
      if(!s) return "";
      return s.charAt(0).toUpperCase() + s.slice(1);
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function format(sig){
      const first = (sig.firstName || "").trim();
      const last  = (sig.lastName || "").trim();
      const lastInitial = last ? (last[0].toUpperCase() + ".") : "";
      const area  = (sig.area || "").trim();
      const zip   = (sig.zip || "").trim();
      return {
        who: `${cap(first)} ${lastInitial}`.trim(),
        meta: `${area} • ${zip}`
      };
    }

    function render(){
      const list = document.getElementById("sigList");
      const sigs = loadSigs().slice(-12).reverse();

      if(!sigs.length){
        list.innerHTML = `<div class="empty">Be the first to sign.</div>`;
        return;
      }

      list.innerHTML = sigs.map(s => {
        const f = format(s);
        return `
          <div class="sig">
            <div class="who">${escapeHtml(f.who)}</div>
            <div class="meta">${escapeHtml(f.meta)}</div>
          </div>
        `;
      }).join("");
    }

    document.getElementById("signForm").addEventListener("submit", (e) => {
      e.preventDefault();

      const firstName = document.getElementById("firstName").value.trim();
      const lastName  = document.getElementById("lastName").value.trim();
      const area      = document.getElementById("area").value.trim();
      const email     = document.getElementById("email").value.trim();
      const zip       = document.getElementById("zip").value.trim();

      if(!/^\d{5}$/.test(zip)){
        alert("Please enter a valid 5-digit zip code.");
        return;
      }


      const sigs = loadSigs();
      sigs.push({ firstName, lastName, area, email, zip, signedAt: new Date().toISOString() });
      saveSigs(sigs);

      // Refresh to show the signature like you asked
      location.reload();
    });

    render();
  </script>
</body>
</html>
